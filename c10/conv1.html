<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NB76SV96');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‘ê·¼ë‘ê·¼ ìœ í•™ í”Œë˜ë„ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .grammar-highlight {
            color: #000000; /* Black color */
            font-weight: 700;
        }
        .choice-button {
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
        }
        .choice-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            border-color: #38bdf8; /* Sky blue border */
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
        }
        /* Stat change indicator animation */
        .stat-indicator {
            position: absolute;
            right: 10px;
            top: 5px;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            animation: fade-up-out 1.5s ease-in-out forwards;
        }
        @keyframes fade-up-out {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }
    </style>
</head>
<body class="bg-sky-100 flex items-center justify-center min-h-screen p-4">

    <!-- View Switcher Buttons -->
    <div class="fixed top-4 right-4 z-50 flex gap-2">
        <button id="mobile-view-btn" class="bg-white/80 backdrop-blur-sm text-sm px-4 py-2 rounded-full shadow-md font-semibold text-slate-700 transition-colors">
            ğŸ“± ëª¨ë°”ì¼ ë³´ê¸°
        </button>
        <button id="wide-view-btn" class="bg-white/80 backdrop-blur-sm text-sm px-4 py-2 rounded-full shadow-md font-semibold text-slate-700 transition-colors">
            ğŸ–¥ï¸ ì™€ì´ë“œ ë³´ê¸°
        </button>
    </div>

    <!-- The main container now uses flexbox to manage the layout for different screen sizes -->
    <div id="game-container" class="bg-white rounded-2xl shadow-2xl p-4 sm:p-6 md:p-8 max-w-6xl w-full mx-auto flex flex-col lg:flex-row gap-8">
        
        <!-- STATS UI: On the left for large screens (lg), stacked vertically -->
        <div id="stats-container" class="w-full lg:w-1/4 order-2 lg:order-1 grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-1 gap-4">
            <!-- Stats will be dynamically inserted here -->
        </div>

        <!-- MAIN CONTENT: In the center/right -->
        <div id="main-content" class="w-full lg:w-3/4 order-1 lg:order-2 flex flex-col items-center">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-center text-sky-500 mb-2">ë‘ê·¼ë‘ê·¼ ìœ í•™ í”Œë˜ë„ˆ âœˆï¸</h1>
            <p class="text-center text-slate-600 mb-6 md:text-lg">ë‹¹ì‹ ì˜ ì„ íƒìœ¼ë¡œ ìœ í•™ ì¤€ë¹„ë¥¼ ì™„ì„±í•˜ì„¸ìš”!</p>

            <div class="bg-slate-50 rounded-lg p-4 sm:p-6 mb-6 w-full max-w-3xl flex flex-col justify-center min-h-[200px]">
                <div class="flex items-center gap-4">
                    <img id="avatar" src="https://placehold.co/80x80/bae6fd/333333?text=ğŸ§‘â€ğŸ“" alt="Avatar" class="rounded-full w-20 h-20 md:w-24 md:h-24 flex-shrink-0">
                    <div>
                        <h2 id="story-title" class="font-bold text-xl md:text-2xl text-slate-800 mb-1">ìœ í•™ ê²°ì‹¬</h2>
                        <p id="story-text" class="text-slate-700 text-lg md:text-xl">ê²Œì„ì´ ê³§ ì‹œì‘ë©ë‹ˆë‹¤...</p>
                    </div>
                </div>
            </div>
            
            <div id="choices-container" class="grid grid-cols-1 gap-4 w-full max-w-3xl">
                <!-- Choices will be dynamically inserted here with larger text -->
            </div>
        </div>
    </div>


    <!-- Modal for Endings -->
    <div id="modal-container" class="hidden fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 max-w-md w-full mx-auto text-center">
            <img id="modal-image" src="" class="w-24 h-24 mx-auto mb-4 rounded-full" alt="Result Image">
            <h2 id="modal-title" class="text-2xl font-bold text-slate-800 mb-2"></h2>
            <p id="modal-text" class="text-slate-700 mb-6"></p>
            <div id="modal-stats-container" class="mb-6"></div>
            <button id="restart-button" class="w-full bg-sky-500 text-white p-3 rounded-lg font-bold hover:bg-sky-600">ë‹¤ì‹œ ê³„íší•˜ê¸°</button>
        </div>
    </div>

<script>
    const initialStats = {
        progress: { name: 'ğŸ“ ì¤€ë¹„', value: 0, color: 'bg-sky-400' },
        language: { name: 'ğŸ—£ï¸ ì–¸ì–´', value: 20, color: 'bg-violet-500' },
        budget: { name: 'ğŸ’° ì˜ˆì‚°', value: 50, color: 'bg-green-500' },
        stress: { name: 'ğŸ˜¥ ìŠ¤íŠ¸ë ˆìŠ¤', value: 10, color: 'bg-amber-500' }
    };

    let stats = JSON.parse(JSON.stringify(initialStats));

    const events = {
        start: {
            title: "ìœ í•™ ê²°ì‹¬",
            story: "ì™€, ìœ í•™ì„ ê°€ê¸°ë¡œ ê²°ì‹¬í–ˆêµ°ìš”! ê°€ì¥ ë¨¼ì € ë¬´ì—‡ì„ í•  ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ§‘â€ğŸ“",
            choices: [
                { text: "ê°€ê³  ì‹¶ì€ ë‚˜ë¼ì™€ í•™êµë¶€í„° <span class='grammar-highlight'>ì•Œì•„ë³¼ ìƒê°ì´ì—ìš”</span>.", effect: { stress: 5, progress: 10 }, next: 'choose_country' },
                { text: "í•„ìš”í•œ ì„œë¥˜ê°€ ë¬´ì—‡ì¸ì§€ <span class='grammar-highlight'>í™•ì¸í•  ê³„íšì´ì—ìš”</span>.", effect: { stress: 10, progress: 10 }, next: 'choose_country' },
            ]
        },
        choose_country: {
            title: "ë‚˜ë¼ì™€ í•™êµ ì •í•˜ê¸°",
            story: "ì¢‹ì€ ìƒê°ì´ë„¤ìš”. ì–´ëŠ ë‚˜ë¼, ì–´ëŠ í•™êµë¡œ ê°ˆì§€ ì •í–ˆì–´ìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ—ºï¸",
            choices: [
                { text: "ë¯¸êµ­ì— ìˆëŠ” ëª…ë¬¸ ëŒ€í•™êµì— <span class='grammar-highlight'>ê°ˆ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 15, budget: -20, language: 10, stress: 10 }, next: 'prepare_language' },
                { text: "í•™ë¹„ê°€ ì €ë ´í•œ ìœ ëŸ½ìœ¼ë¡œ <span class='grammar-highlight'>ê°ˆ ì˜ˆì •ì´ì—ìš”</span>.", effect: { progress: 15, budget: 10, stress: 5 }, next: 'prepare_language' },
            ]
        },
        prepare_language: {
            title: "ì–¸ì–´ ì¤€ë¹„",
            story: "ìœ í•™ ê°€ë ¤ë©´ ì–¸ì–´ ì ìˆ˜ê°€ í•„ìš”í•˜ì£ . ì–´ë–»ê²Œ ì¤€ë¹„í•  ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ“š",
            choices: [
                { text: "ë§¤ì¼ ë„ì„œê´€ì—ì„œ í˜¼ì <span class='grammar-highlight'>ê³µë¶€í•  ê³„íšì´ì—ìš”</span>.", effect: { budget: 5, stress: 10, language: 20 }, next: 'prepare_budget' },
                { text: "ë¹„ì‹¸ì§€ë§Œ, í•™ì›ì— ë‹¤ë‹ˆë©´ì„œ <span class='grammar-highlight'>ì¤€ë¹„í•  ìƒê°ì´ì—ìš”</span>.", effect: { budget: -15, stress: -5, language: 30 }, next: 'prepare_budget' }
            ]
        },
        prepare_budget: {
            title: "ìœ í•™ ë¹„ìš© ë§ˆë ¨í•˜ê¸°",
            story: "ìœ í•™ ë¹„ìš©ì´ ë§Œë§Œì¹˜ ì•Šì€ë°, ëˆì€ ì–´ë–»ê²Œ ë§ˆë ¨í•  ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ¦",
            choices: [
                { text: "ë¶€ëª¨ë‹˜ê»˜ ë„ì›€ì„ <span class='grammar-highlight'>ë¶€íƒë“œë¦´ ì˜ˆì •ì´ì—ìš”</span>.", effect: { budget: 30, stress: -10 }, next: 'prepare_housing' },
                { text: "ì—´ì‹¬íˆ ì•„ë¥´ë°”ì´íŠ¸ë¥¼ í•´ì„œ <span class='grammar-highlight'>ëª¨ì„ ìƒê°ì´ì—ìš”</span>.", effect: { budget: 15, stress: 15, language: -5 }, next: 'prepare_housing' }
            ]
        },
        prepare_housing: {
            title: "ì‚´ ê³³ ì •í•˜ê¸°",
            story: "ì´ì œ ì™¸êµ­ì—ì„œ ì‚´ ì§‘ì„ êµ¬í•´ì•¼ê² ë„¤ìš”. ì–´ë””ì„œ ì‚´ ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ¡",
            choices: [
                { text: "ì•ˆì „í•œ í•™êµ ê¸°ìˆ™ì‚¬ì—ì„œ <span class='grammar-highlight'>ì‚´ ê³„íšì´ì—ìš”</span>.", effect: { progress: 20, budget: -15, stress: -10 }, next: 'final_step' },
                { text: "í˜„ì§€ ì¹œêµ¬ë“¤ê³¼ ì§‘ì„ ë¹Œë ¤ì„œ <span class='grammar-highlight'>ì‚´ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: 5, stress: 10, language: 10 }, next: 'final_step' }
            ]
        },
        final_step: {
            title: "ë§ˆì§€ë§‰ ì¤€ë¹„",
            story: "ê±°ì˜ ë‹¤ ì¤€ë¹„ëë„¤ìš”! ë– ë‚˜ê¸° ì „ì— ë§ˆì§€ë§‰ìœ¼ë¡œ ë¬´ì—‡ì„ í•˜ê³  ì‹¶ì–´ìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ì§",
            choices: [
                { text: "ê°€ì¡±, ì¹œêµ¬ë“¤ê³¼ ì‹œê°„ì„ <span class='grammar-highlight'>ë³´ë‚¼ ì˜ˆì •ì´ì—ìš”</span>.", effect: { stress: -15, progress: 10 }, next: 'end' },
                { text: "í•œêµ­ ìŒì‹ì„ ë§ˆìŒê» <span class='grammar-highlight'>ë¨¹ì–´ ë‘˜ ìƒê°ì´ì—ìš”</span>.", effect: { stress: -10, progress: 10 }, next: 'end' }
            ]
        },
        end: {} // Trigger
    };

    const DOM = {
        gameContainer: document.getElementById('game-container'),
        statsContainer: document.getElementById('stats-container'),
        mainContent: document.getElementById('main-content'),
        storyTitle: document.getElementById('story-title'),
        storyText: document.getElementById('story-text'),
        choicesContainer: document.getElementById('choices-container'),
        avatar: document.getElementById('avatar'),
        modal: {
            container: document.getElementById('modal-container'),
            image: document.getElementById('modal-image'),
            title: document.getElementById('modal-title'),
            text: document.getElementById('modal-text'),
            statsContainer: document.getElementById('modal-stats-container'),
            restartButton: document.getElementById('restart-button')
        },
        viewSwitcher: {
            mobileBtn: document.getElementById('mobile-view-btn'),
            wideBtn: document.getElementById('wide-view-btn')
        }
    };

    function updateStatsUI() {
        DOM.statsContainer.innerHTML = '';
        for (const key in stats) {
            const stat = stats[key];
            const statElement = document.createElement('div');
            statElement.className = "bg-slate-100 p-3 rounded-lg relative";
            statElement.id = `stat-box-${key}`;
            statElement.innerHTML = `
                <div class="flex justify-between mb-1 items-center">
                    <span class="font-semibold text-slate-700 text-sm md:text-base">${stat.name}</span>
                    <span class="font-bold text-slate-800 md:text-base">${stat.value}/100</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div class="h-2.5 rounded-full progress-bar-fill ${stat.color}" style="width: ${Math.min(stat.value, 100)}%"></div>
                </div>`;
            DOM.statsContainer.appendChild(statElement);
        }
    }

    function showStatChange(key, change) {
        const statBox = document.getElementById(`stat-box-${key}`);
        if (!statBox) return;

        const indicator = document.createElement('div');
        indicator.textContent = `${change > 0 ? '+' : ''}${change}`;
        indicator.className = `stat-indicator ${change > 0 ? 'bg-green-500' : 'bg-red-500'}`;
        
        statBox.appendChild(indicator);

        setTimeout(() => indicator.remove(), 1500);
    }

    function showEvent(eventId) {
        if (eventId === 'end') {
            showEndingScreen();
            return;
        }

        const event = events[eventId];
        DOM.storyTitle.textContent = event.title;
        DOM.storyText.textContent = event.story;
        DOM.avatar.src = event.avatar;
        DOM.choicesContainer.innerHTML = '';

        if (event.choices) {
            event.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = "choice-button w-full bg-sky-500 text-white p-4 md:p-5 rounded-lg font-bold hover:bg-sky-600 text-left text-lg md:text-xl";
                button.innerHTML = choice.text;
                button.onclick = () => selectChoice(choice);
                DOM.choicesContainer.appendChild(button);
            });
        }
        updateStatsUI();
    }
    
    function showEndingScreen() {
        let endingTitle = "ë‚˜ì˜ ìœ í•™ ì¤€ë¹„ ê²°ê³¼ëŠ”?";
        let endingMessage = "";
        let endingAvatar = "";

        const { progress, language, budget, stress } = stats;

        if (progress >= 80 && language >= 80 && budget >= 50 && stress < 50) {
            endingMessage = "ì™„ë²½í•´ìš”! ëª¨ë“  ê²ƒì„ ìˆœì¡°ë¡­ê²Œ ì¤€ë¹„í–ˆì–´ìš”. ë‹¹ì‹ ì˜ ìœ í•™ ìƒí™œì€ ì„±ê³µì ì¼ ê±°ì˜ˆìš”. ìì‹ ê°ì„ ê°–ê³  ë– ë‚˜ì„¸ìš”!";
            endingAvatar = "https://placehold.co/80x80/fde047/333333?text=ğŸ‘";
        } else if (budget >= 80 && stress < 60) {
            endingMessage = "ì•Œëœ°ì‚´ëœ° ì¤€ë¹„ ì™„ë£Œ! ì•„ë‚€ ëˆìœ¼ë¡œ ë” ë§ì€ ê²ƒì„ ê²½í—˜í•  ìˆ˜ ìˆê² ì–´ìš”. í˜„ëª…í•œ ìœ í•™ìƒì´ë„¤ìš”!";
            endingAvatar = "https://placehold.co/80x80/86efac/333333?text=ğŸ’°";
        } else if (language >= 90) {
            endingMessage = "ì–¸ì–´ëŠ” ì™„ë²½ ë§ˆìŠ¤í„°! í˜„ì§€ì¸ë“¤ê³¼ ììœ ë¡­ê²Œ ì†Œí†µí•˜ë©° ê¹Šì´ ìˆëŠ” ìœ í•™ ìƒí™œì„ ì¦ê¸°ì„¸ìš”!";
            endingAvatar = "https://placehold.co/80x80/c084fc/333333?text=ğŸ’¯";
        } else if (stress >= 60) {
            endingMessage = "ì¤€ë¹„ ê³¼ì •ì´ ì¡°ê¸ˆ í˜ë“¤ì—ˆì§€ë§Œ, ë‹¹ì‹ ì€ í•´ëƒˆì–´ìš”! í˜ë“  ë§Œí¼ ë” ë§ì´ ë°°ìš°ê³  ì„±ì¥í•  ê±°ì˜ˆìš”.";
            endingAvatar = "https://placehold.co/80x80/fca5a5/333333?text=ğŸ˜¥";
        } else {
            endingMessage = "ì´ì œ ë– ë‚  ì‹œê°„ì´ì—ìš”! ë¶€ì¡±í•œ ë¶€ë¶„ì€ í˜„ì§€ì—ì„œ ë¶€ë”ªíˆë©° ë°°ìš°ë©´ ë¼ìš”. ìš©ê°í•œ ë„ì „ì„ ì‘ì›í•©ë‹ˆë‹¤!";
            endingAvatar = "https://placehold.co/80x80/67e8f9/333333?text=ğŸ˜Š";
        }

        DOM.modal.image.src = endingAvatar;
        DOM.modal.title.textContent = endingTitle;
        DOM.modal.text.textContent = endingMessage;
        DOM.modal.statsContainer.innerHTML = DOM.statsContainer.innerHTML;
        DOM.modal.container.classList.remove('hidden');
    }

    function selectChoice(choice) {
        const buttons = DOM.choicesContainer.getElementsByTagName('button');
        for (const button of buttons) {
            button.disabled = true;
            button.classList.add('opacity-50', 'cursor-not-allowed');
        }

        if (choice.effect) {
            for (const key in choice.effect) {
                const change = choice.effect[key];
                stats[key].value += change;
                if (stats[key].value < 0) stats[key].value = 0;
                if (stats[key].value > 100) stats[key].value = 100;
                showStatChange(key, change);
            }
        }
        
        setTimeout(() => {
            updateStatsUI();
            showEvent(choice.next);
        }, 1200);
    }

    function restartGame() {
        stats = JSON.parse(JSON.stringify(initialStats));
        DOM.modal.container.classList.add('hidden');
        showEvent('start');
    }

    // --- View Switcher Logic ---
    function setViewMode(mode) {
        const { gameContainer, statsContainer, mainContent, viewSwitcher } = DOM;
        
        // Reset all layout classes first
        gameContainer.classList.remove('flex-col', 'lg:flex-row', 'flex-row');
        statsContainer.classList.remove('w-full', 'order-2', 'lg:w-1/4', 'lg:order-1', 'grid-cols-1', 'lg:grid-cols-1', 'w-1/4', 'order-1');
        mainContent.classList.remove('w-full', 'order-1', 'lg:w-3/4', 'lg:order-2', 'w-3/4', 'order-2');

        if (mode === 'mobile') {
            gameContainer.classList.add('flex-col');
            statsContainer.classList.add('w-full', 'order-2', 'grid-cols-2', 'sm:grid-cols-2');
            mainContent.classList.add('w-full', 'order-1');
            
            viewSwitcher.mobileBtn.classList.add('bg-sky-500', 'text-white');
            viewSwitcher.mobileBtn.classList.remove('bg-white/80', 'text-slate-700');
            viewSwitcher.wideBtn.classList.remove('bg-sky-500', 'text-white');
            viewSwitcher.wideBtn.classList.add('bg-white/80', 'text-slate-700');
        } else { // wide mode
            gameContainer.classList.add('flex-row');
            statsContainer.classList.add('w-1/4', 'order-1', 'grid-cols-1');
            mainContent.classList.add('w-3/4', 'order-2');

            viewSwitcher.wideBtn.classList.add('bg-sky-500', 'text-white');
            viewSwitcher.wideBtn.classList.remove('bg-white/80', 'text-slate-700');
            viewSwitcher.mobileBtn.classList.remove('bg-sky-500', 'text-white');
            viewSwitcher.mobileBtn.classList.add('bg-white/80', 'text-slate-700');
        }
    }

    DOM.viewSwitcher.mobileBtn.onclick = () => setViewMode('mobile');
    DOM.viewSwitcher.wideBtn.onclick = () => setViewMode('wide');
    DOM.modal.restartButton.onclick = restartGame;
    
    window.onload = () => {
        showEvent('start');
        // Set initial view based on screen size, but allow override
        if (window.innerWidth < 1024) {
            setViewMode('mobile');
        } else {
            setViewMode('wide');
        }
    };
</script>

</body>
</html>
