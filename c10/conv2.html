<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‘ê·¼ë‘ê·¼ ì›¨ë”© í”Œë˜ë„ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .grammar-highlight {
            color: #000000; /* Black color */
            font-weight: 700;
        }
        .choice-button {
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
        }
        .choice-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            border-color: #f9a8d4; /* Pink border */
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
        }
        /* Stat change indicator animation */
        .stat-indicator {
            position: absolute;
            right: 10px;
            top: 5px;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            animation: fade-up-out 1.5s ease-in-out forwards;
        }
        @keyframes fade-up-out {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }
    </style>
</head>
<body class="bg-pink-100 flex items-center justify-center min-h-screen p-4">

    <!-- View Switcher Buttons -->
    <div class="fixed top-4 right-4 z-50 flex gap-2">
        <button id="mobile-view-btn" class="bg-white/80 backdrop-blur-sm text-sm px-4 py-2 rounded-full shadow-md font-semibold text-slate-700 transition-colors">
            ğŸ“± ëª¨ë°”ì¼ ë³´ê¸°
        </button>
        <button id="wide-view-btn" class="bg-white/80 backdrop-blur-sm text-sm px-4 py-2 rounded-full shadow-md font-semibold text-slate-700 transition-colors">
            ğŸ–¥ï¸ ì™€ì´ë“œ ë³´ê¸°
        </button>
    </div>

    <!-- The main container now uses flexbox to manage the layout for different screen sizes -->
    <div id="game-container" class="bg-white rounded-2xl shadow-2xl p-4 sm:p-6 md:p-8 max-w-6xl w-full mx-auto flex flex-col lg:flex-row gap-8">
        
        <!-- STATS UI: On the left for large screens (lg), stacked vertically -->
        <div id="stats-container" class="w-full lg:w-1/4 order-2 lg:order-1 grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-1 gap-4">
            <!-- Stats will be dynamically inserted here -->
        </div>

        <!-- MAIN CONTENT: In the center/right -->
        <div id="main-content" class="w-full lg:w-3/4 order-1 lg:order-2 flex flex-col items-center">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-center text-pink-500 mb-2">ë‘ê·¼ë‘ê·¼ ì›¨ë”© í”Œë˜ë„ˆ ğŸ’</h1>
            <p class="text-center text-slate-600 mb-6 md:text-lg">ë‹¹ì‹ ì˜ ì„ íƒìœ¼ë¡œ ê²°í˜¼ ì¤€ë¹„ë¥¼ ì™„ì„±í•˜ì„¸ìš”!</p>

            <div class="bg-slate-50 rounded-lg p-4 sm:p-6 mb-6 w-full max-w-3xl flex flex-col justify-center min-h-[200px]">
                <div class="flex items-center gap-4">
                    <img id="avatar" src="https://placehold.co/80x80/fbcfe8/333333?text=ğŸ¤µ" alt="Avatar" class="rounded-full w-20 h-20 md:w-24 md:h-24 flex-shrink-0">
                    <div>
                        <h2 id="story-title" class="font-bold text-xl md:text-2xl text-slate-800 mb-1">ì¹œêµ¬ ì•„í‚¤ë¼ì˜ ì¶•í•˜</h2>
                        <p id="story-text" class="text-slate-700 text-lg md:text-xl">ê²Œì„ì´ ê³§ ì‹œì‘ë©ë‹ˆë‹¤...</p>
                    </div>
                </div>
            </div>
            
            <div id="choices-container" class="grid grid-cols-1 gap-4 w-full max-w-3xl">
                <!-- Choices will be dynamically inserted here with larger text -->
            </div>
        </div>
    </div>


    <!-- Modal for Endings (layout unchanged) -->
    <div id="modal-container" class="hidden fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 max-w-md w-full mx-auto text-center">
            <img id="modal-image" src="" class="w-24 h-24 mx-auto mb-4 rounded-full" alt="Result Image">
            <h2 id="modal-title" class="text-2xl font-bold text-slate-800 mb-2"></h2>
            <p id="modal-text" class="text-slate-700 mb-6"></p>
            <div id="modal-stats-container" class="mb-6"></div>
            <button id="restart-button" class="w-full bg-pink-500 text-white p-3 rounded-lg font-bold hover:bg-pink-600">ë‹¤ì‹œ ê³„íší•˜ê¸°</button>
        </div>
    </div>

<script>
    const initialStats = {
        progress: { name: 'ğŸ’– ì¤€ë¹„', value: 0, color: 'bg-pink-400' },
        love: { name: 'ğŸ¥° ì‚¬ë‘', value: 80, color: 'bg-red-500' },
        budget: { name: 'ğŸ’° ì˜ˆì‚°', value: 70, color: 'bg-green-500' },
        stress: { name: 'ğŸ¤¯ ìŠ¤íŠ¸ë ˆìŠ¤', value: 10, color: 'bg-yellow-500' }
    };

    let stats = JSON.parse(JSON.stringify(initialStats));

    const events = {
        start: {
            title: "ì¹œêµ¬ ì•„í‚¤ë¼ì˜ ì¶•í•˜",
            story: "ì˜¤ë«ë™ì•ˆ ì—°ì• í•˜ë”ë‹ˆ ë“œë””ì–´ ê²°í˜¼í•˜ë„¤ìš”. ì¤€ë¹„ëŠ” ë‹¤ ëì–´ìš”?",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ¤µ",
            choices: [
                { text: "ê²°í˜¼ ì¤€ë¹„ ë‹¤ í•˜ë ¤ë©´ ì•„ì§ ë©€ì—ˆì–´ìš”. í•  ì¼ì´ ë§ì•„ìš”.", effect: { stress: 5, progress: 10 }, next: 'ask_house' },
            ]
        },
        ask_house: {
            title: "ì‹ í˜¼ì§‘ ê²°ì •í•˜ê¸°",
            story: "í•  ì¼ì´ ë§ë„¤ìš”. ê°€ì¥ ì¤‘ìš”í•œ ì‹ í˜¼ì§‘ì€ ì–´ë””ë¡œ ì •í–ˆì–´ìš”?",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ ",
            choices: [
                { text: "ì§€ê¸ˆ ì‚¬ëŠ” ì˜¤í”¼ìŠ¤í…”ì—ì„œ ì‹ í˜¼ì‚´ë¦¼ì„ <span class='grammar-highlight'>ì‹œì‘í•  ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: 10, love: -10, stress: 10 }, next: 'house_reaction_officetel' },
                { text: "ì—¬ìì¹œêµ¬ë¥¼ ìœ„í•´ ë” ë„“ì€ ì§‘ìœ¼ë¡œ <span class='grammar-highlight'>ê°ˆ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: -30, love: 15 }, next: 'house_reaction_large' },
                { text: "ë¶€ëª¨ë‹˜ ëŒì— ë“¤ì–´ê°€ì„œ <span class='grammar-highlight'>ì‚´ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: 30, love: -5, stress: 5 }, next: 'house_reaction_parents' }
            ]
        },
        house_reaction_officetel: {
            title: "ì—¬ìì¹œêµ¬ì˜ ë°˜ì‘",
            story: "ì•„, ê·¸ëŸ¼ íšŒì‚¬ì—ì„œ ê°€ê¹ê³  ì¢‹ë„¤ìš”. ê·¸ëŸ°ë° ì—¬ìì¹œêµ¬ëŠ” ë” ë„“ì€ ì§‘ì—ì„œ ì‚´ê³  ì‹¶ëŒ€ìš”. ì„œë¡œ ë§ˆìŒì´ ì˜ ë§ëŠ”ë‹¤ê³  ìƒê°í–ˆëŠ”ë°... ê²°í˜¼ ì¤€ë¹„ê°€ ì‰½ì§€ ì•Šêµ°ìš”.",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ˜¥",
            choices: [
                { text: "ë„¤, ì •ë§ ìƒê°ë³´ë‹¤ ì‰½ì§€ ì•Šë„¤ìš”...", effect: { stress: 10 }, next: 'next_task' }
            ]
        },
        house_reaction_large: {
            title: "ì—¬ìì¹œêµ¬ì˜ ë°˜ì‘",
            story: "ì™€, ì •ë§ìš”? ì—¬ìì¹œêµ¬ê°€ ì •ë§ ì¢‹ì•„í•˜ê² ì–´ìš”! ì—­ì‹œ ì²œìƒì—°ë¶„ì´ë„¤ìš”.",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ˜",
            choices: [
                { text: "í•˜í•˜, ê·¸ëŸ°ê°€ìš”? ê¸°ë¶„ì´ ì¢‹ë„¤ìš”.", effect: { love: 10, stress: -5 }, next: 'next_task' }
            ]
        },
        house_reaction_parents: {
            title: "ì—¬ìì¹œêµ¬ì˜ ë°˜ì‘",
            story: "ë¶€ëª¨ë‹˜ê³¼ í•¨ê»˜ ì‚¬ëŠ”êµ°ìš”. ëˆì€ ì•„ë‚„ ìˆ˜ ìˆê² ì§€ë§Œ, ì—¬ìì¹œêµ¬ëŠ” ì¡°ê¸ˆ ë¶ˆí¸í•  ìˆ˜ë„ ìˆê² ì–´ìš”.",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ¤”",
            choices: [
                { text: "ê´œì°®ì„ ê±°ì˜ˆìš”. ì˜ ì´ì•¼ê¸°í•´ ë³¼ê²Œìš”.", effect: { stress: 5 }, next: 'next_task' }
            ]
        },
        next_task: {
            title: "ë‹¤ìŒ ì¤€ë¹„ëŠ”?",
            story: "ì‹ í˜¼ì§‘ë„ ì •í–ˆìœ¼ë‹ˆ, ì´ì œ ë‹¤ë¥¸ ì¤€ë¹„ë¥¼ í•´ì•¼ì£ ! ë‹¤ìŒì€ ë¬´ì—‡ì„ í•  ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ“‹",
            choices: [
                { text: "ì´ì œ <span class='grammar-highlight'>ì²­ì²©ì¥ì„ ë³´ë‚¼ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: -5, stress: 5 }, next: 'buy_furniture' },
                { text: "ë¯¸ë¦¬ <span class='grammar-highlight'>ì‹ í˜¼ì—¬í–‰ì„ ì˜ˆì•½í•  ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: -20, stress: -5 }, next: 'buy_furniture' }
            ]
        },
        buy_furniture: {
            title: "ê°€êµ¬ ì‚¬ê¸°",
            story: "ì§‘ì— í•„ìš”í•œ ê°€êµ¬ë„ ì‚¬ì•¼ì§€ìš”. ì–´ë–¤ ê°€êµ¬ë¥¼ ì‚´ ê±°ì˜ˆìš”?",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ›‹ï¸",
            choices: [
                { text: "ê¼­ í•„ìš”í•œ ê²ƒë§Œ ì €ë ´í•˜ê²Œ <span class='grammar-highlight'>ì‚´ ìƒê°ì´ì—ìš”</span>.", effect: { progress: 20, budget: 10, stress: 5 }, next: 'final_feeling' },
                { text: "ì˜ˆìœ ë””ìì¸ ê°€êµ¬ë¡œ ì§‘ì„ ê¾¸ë°€ <span class='grammar-highlight'>ì˜ˆì •ì´ì—ìš”</span>.", effect: { progress: 20, budget: -20, love: 10 }, next: 'final_feeling' }
            ]
        },
        final_feeling: {
            title: "ê²°í˜¼ì„ ì•ë‘” ë§ˆìŒ",
            story: "ì´ì œ ì •ë§ ê²°í˜¼ì´ ì–¼ë§ˆ ì•ˆ ë‚¨ì•˜ë„¤ìš”. ì¤€ë¹„ëŠ” í˜ë“¤ì—ˆì§€ë§Œ, ê·¸ë˜ë„ ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒê³¼ í•¨ê»˜ ì‚´ ìƒê°ì„ í•˜ë©´ ê°€ìŠ´ì´ ë‘ê·¼ê±°ë ¤ìš”.",
            avatar: "https://placehold.co/80x80/fbcfe8/333333?text=ğŸ¥°",
            choices: [
                { text: "ë„¤, ì •ë§ ì²œìƒì—°ë¶„ì¸ê°€ ë´ìš”. (ê²°ê³¼ í™•ì¸í•˜ê¸°)", next: 'end', effect: { progress: 30, love: 10 } }
            ]
        },
        end: {} // Trigger
    };

    const DOM = {
        gameContainer: document.getElementById('game-container'),
        statsContainer: document.getElementById('stats-container'),
        mainContent: document.getElementById('main-content'),
        storyTitle: document.getElementById('story-title'),
        storyText: document.getElementById('story-text'),
        choicesContainer: document.getElementById('choices-container'),
        avatar: document.getElementById('avatar'),
        modal: {
            container: document.getElementById('modal-container'),
            image: document.getElementById('modal-image'),
            title: document.getElementById('modal-title'),
            text: document.getElementById('modal-text'),
            statsContainer: document.getElementById('modal-stats-container'),
            restartButton: document.getElementById('restart-button')
        },
        viewSwitcher: {
            mobileBtn: document.getElementById('mobile-view-btn'),
            wideBtn: document.getElementById('wide-view-btn')
        }
    };

    function updateStatsUI() {
        DOM.statsContainer.innerHTML = '';
        for (const key in stats) {
            const stat = stats[key];
            const statElement = document.createElement('div');
            statElement.className = "bg-slate-100 p-3 rounded-lg relative";
            statElement.id = `stat-box-${key}`;
            statElement.innerHTML = `
                <div class="flex justify-between mb-1 items-center">
                    <span class="font-semibold text-slate-700 text-sm md:text-base">${stat.name}</span>
                    <span class="font-bold text-slate-800 md:text-base">${(key === 'stress' ? '' : stat.value + '/100')}</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div class="h-2.5 rounded-full progress-bar-fill ${stat.color}" style="width: ${Math.min(stat.value, 100)}%"></div>
                </div>`;
            DOM.statsContainer.appendChild(statElement);
        }
    }

    function showStatChange(key, change) {
        const statBox = document.getElementById(`stat-box-${key}`);
        if (!statBox) return;

        const indicator = document.createElement('div');
        indicator.textContent = `${change > 0 ? '+' : ''}${change}`;
        indicator.className = `stat-indicator ${change > 0 ? 'bg-green-500' : 'bg-red-500'}`;
        
        statBox.appendChild(indicator);

        setTimeout(() => indicator.remove(), 1500);
    }

    function showEvent(eventId) {
        if (eventId === 'end') {
            showEndingScreen();
            return;
        }

        const event = events[eventId];
        DOM.storyTitle.textContent = event.title;
        DOM.storyText.textContent = event.story;
        DOM.avatar.src = event.avatar;
        DOM.choicesContainer.innerHTML = '';

        if (event.choices) {
            event.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = "choice-button w-full bg-pink-500 text-white p-4 md:p-5 rounded-lg font-bold hover:bg-pink-600 text-left text-lg md:text-xl";
                button.innerHTML = choice.text;
                button.onclick = () => selectChoice(choice);
                DOM.choicesContainer.appendChild(button);
            });
        }
        updateStatsUI();
    }
    
    function showEndingScreen() {
        let endingTitle = "ìš°ë¦¬ì˜ ê²°í˜¼ ì¤€ë¹„ ê²°ê³¼ëŠ”?";
        let endingMessage = "";
        let endingAvatar = "";

        const { progress, love, budget, stress } = stats;

        if (progress >= 100 && love >= 90 && budget >= 50 && stress < 50) {
            endingMessage = "ì™„ë²½í•´ìš”! ëª¨ë“  ê²ƒì„ ìˆœì¡°ë¡­ê²Œ ì¤€ë¹„í–ˆê³ , ë‘ ì‚¬ëŒì˜ ì‚¬ë‘ì€ ë”ìš± ê¹Šì–´ì¡Œì–´ìš”. ëª¨ë‘ê°€ ë¶€ëŸ¬ì›Œí•˜ëŠ” ê¿ˆì˜ ê²°í˜¼ì‹ì´ ë  ê±°ì˜ˆìš”!";
            endingAvatar = "https://placehold.co/80x80/fde047/333333?text=ğŸ’–";
        } else if (budget >= 80 && stress < 60) {
            endingMessage = "ì •ë§ ì•Œëœ°í•˜ê²Œ ì¤€ë¹„í–ˆë„¤ìš”! ì•„ë‚€ ì˜ˆì‚°ìœ¼ë¡œ ë” í–‰ë³µí•œ ì‹ í˜¼ ìƒí™œì„ ì‹œì‘í•  ìˆ˜ ìˆê² ì–´ìš”. ë‹¹ì‹ ì€ ìµœê³ ì˜ ì›¨ë”© í”Œë˜ë„ˆ!";
            endingAvatar = "https://placehold.co/80x80/86efac/333333?text=ğŸ’°";
        } else if (love >= 100 && budget < 40) {
            endingMessage = "ì‚¬ë‘ë§Œ ìˆë‹¤ë©´ ë¬´ì—‡ë„ ë‘ë µì§€ ì•Šì£ ! ì˜ˆì‚°ì€ ë¶€ì¡±í–ˆì§€ë§Œ, ì„œë¡œë¥¼ í–¥í•œ ì‚¬ë‘ìœ¼ë¡œ ëª¨ë“  ì–´ë ¤ì›€ì„ ì´ê²¨ëƒˆì–´ìš”.";
            endingAvatar = "https://placehold.co/80x80/f9a8d4/333333?text=ğŸ˜";
        } else if (stress >= 60) {
            endingMessage = "ê²°í˜¼ ì¤€ë¹„ê°€ ë„ˆë¬´ í˜ë“¤ì—ˆêµ°ìš”. ìŠ¤íŠ¸ë ˆìŠ¤ëŠ” ë§ì•˜ì§€ë§Œ, í˜ë“  ê³¼ì •ì„ í•¨ê»˜ ì´ê²¨ëƒˆìœ¼ë‹ˆ ì•ìœ¼ë¡œ ë” í–‰ë³µí•  ê±°ì˜ˆìš”. ì¡°ê¸ˆë§Œ í˜ë‚´ìš”!";
            endingAvatar = "https://placehold.co/80x80/fca5a5/333333?text=ğŸ¤¯";
        } else {
            endingMessage = "ì¡°ê¸ˆì€ ì„œíˆ´ë €ì§€ë§Œ, ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒê³¼ í•¨ê»˜ì˜€ê¸°ì— í–‰ë³µí•œ ì¤€ë¹„ ê¸°ê°„ì´ì—ˆì–´ìš”. ë‘ ì‚¬ëŒì˜ ê²°í˜¼ì„ ì¶•í•˜í•©ë‹ˆë‹¤!";
            endingAvatar = "https://placehold.co/80x80/c4b5fd/333333?text=ğŸ˜Š";
        }

        DOM.modal.image.src = endingAvatar;
        DOM.modal.title.textContent = endingTitle;
        DOM.modal.text.textContent = endingMessage;
        DOM.modal.statsContainer.innerHTML = DOM.statsContainer.innerHTML;
        DOM.modal.container.classList.remove('hidden');
    }

    function selectChoice(choice) {
        const buttons = DOM.choicesContainer.getElementsByTagName('button');
        for (const button of buttons) {
            button.disabled = true;
            button.classList.add('opacity-50', 'cursor-not-allowed');
        }

        if (choice.effect) {
            for (const key in choice.effect) {
                const change = choice.effect[key];
                stats[key].value += change;
                if (stats[key].value < 0) stats[key].value = 0;
                if (key === 'stress' && stats[key].value > 100) stats[key].value = 100;
                showStatChange(key, change);
            }
        }
        
        setTimeout(() => {
            updateStatsUI();
            showEvent(choice.next);
        }, 1200);
    }

    function restartGame() {
        stats = JSON.parse(JSON.stringify(initialStats));
        DOM.modal.container.classList.add('hidden');
        showEvent('start');
    }

    // --- View Switcher Logic ---
    function setViewMode(mode) {
        const { gameContainer, statsContainer, mainContent, viewSwitcher } = DOM;
        
        // Reset all layout classes first
        gameContainer.classList.remove('flex-col', 'lg:flex-row', 'flex-row');
        statsContainer.classList.remove('w-full', 'order-2', 'lg:w-1/4', 'lg:order-1', 'grid-cols-1', 'lg:grid-cols-1', 'w-1/4', 'order-1');
        mainContent.classList.remove('w-full', 'order-1', 'lg:w-3/4', 'lg:order-2', 'w-3/4', 'order-2');

        if (mode === 'mobile') {
            gameContainer.classList.add('flex-col');
            statsContainer.classList.add('w-full', 'order-2', 'grid-cols-2', 'sm:grid-cols-2');
            mainContent.classList.add('w-full', 'order-1');
            
            viewSwitcher.mobileBtn.classList.add('bg-pink-500', 'text-white');
            viewSwitcher.mobileBtn.classList.remove('bg-white/80', 'text-slate-700');
            viewSwitcher.wideBtn.classList.remove('bg-pink-500', 'text-white');
            viewSwitcher.wideBtn.classList.add('bg-white/80', 'text-slate-700');
        } else { // wide mode
            gameContainer.classList.add('flex-row');
            statsContainer.classList.add('w-1/4', 'order-1', 'grid-cols-1');
            mainContent.classList.add('w-3/4', 'order-2');

            viewSwitcher.wideBtn.classList.add('bg-pink-500', 'text-white');
            viewSwitcher.wideBtn.classList.remove('bg-white/80', 'text-slate-700');
            viewSwitcher.mobileBtn.classList.remove('bg-pink-500', 'text-white');
            viewSwitcher.mobileBtn.classList.add('bg-white/80', 'text-slate-700');
        }
    }

    DOM.viewSwitcher.mobileBtn.onclick = () => setViewMode('mobile');
    DOM.viewSwitcher.wideBtn.onclick = () => setViewMode('wide');
    DOM.modal.restartButton.onclick = restartGame;
    
    window.onload = () => {
        showEvent('start');
        // Set initial view based on screen size, but allow override
        if (window.innerWidth < 1024) {
            setViewMode('mobile');
        } else {
            setViewMode('wide');
        }
    };
</script>

</body>
</html>

