<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국어 문법: V-(으)ㄹ 생각/계획/예정이다</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        
        /* Vietnamese text hidden by default */
        .vietnamese { 
            color: #4b5563; 
            font-size: 0.9em; 
            font-style: italic; 
            display: none; 
            margin-top: 0.25rem;
        }

        /* Show when body has 'show-vi' class */
        body.show-vi .vietnamese {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-blue-50 min-h-screen flex flex-col items-center p-4">

    <!-- App Container -->
    <div class="bg-white max-w-md w-full rounded-xl shadow-lg overflow-hidden flex flex-col min-h-[80vh]">
        
        <!-- Header -->
        <header class="bg-teal-600 text-white p-4 relative">
            <div class="flex justify-between items-start mb-2">
                <div class="bg-white/20 px-2 py-1 rounded text-xs inline-block">
                    Level 3
                </div>
                
                <div class="flex gap-2">
                    <a href="grammar3-2.html" class="bg-white text-teal-700 px-3 py-1 rounded-full text-xs font-bold hover:bg-teal-50 transition shadow flex items-center no-underline">
                        <i class="fas fa-gamepad mr-1"></i> 게임
                    </a>

                    <button onclick="toggleLanguage()" id="lang-btn" class="bg-white text-teal-700 px-3 py-1 rounded-full text-xs font-bold hover:bg-teal-50 transition shadow">
                        <i class="fas fa-language mr-1"></i> Tiếng Việt
                    </button>
                </div>
            </div>
            
            <div class="text-center pb-2">
                <h1 class="text-xl font-bold">오늘의 문법 (Ngữ pháp)</h1>
                <p class="text-sm opacity-90 mt-1">V-(으)ㄹ 생각[계획, 예정]이다</p>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="flex border-b">
            <button onclick="switchTab('learn')" id="tab-learn" class="flex-1 py-3 text-sm font-medium text-teal-600 border-b-2 border-teal-600 focus:outline-none transition-colors">
                학습
            </button>
            <button onclick="switchTab('quiz')" id="tab-quiz" class="flex-1 py-3 text-sm font-medium text-gray-500 hover:text-teal-600 focus:outline-none transition-colors">
                퀴즈
            </button>
            <button onclick="switchTab('practice')" id="tab-practice" class="flex-1 py-3 text-sm font-medium text-gray-500 hover:text-teal-600 focus:outline-none transition-colors">
                활동
            </button>
        </div>

        <!-- Content Area -->
        <main class="flex-1 p-5 overflow-y-auto">
            
            <!-- Tab 1: Learn -->
            <div id="content-learn" class="fade-in space-y-6">
                
                <!-- Meaning -->
                <div class="bg-teal-50 p-4 rounded-lg border border-teal-100">
                    <h3 class="font-bold text-teal-800 mb-1">의미</h3>
                    <p class="mb-1">미래의 일에 대한 막연한 생각이나 계획을 말할 때 사용해요.</p>
                    <p class="vietnamese">Dùng khi nói về ý định hoặc kế hoạch mơ hồ cho việc trong tương lai.</p>
                </div>

                <!-- Conjugation Rules -->
                <div class="space-y-3">
                    <h3 class="font-bold text-gray-800 border-l-4 border-teal-500 pl-2">형태 변화</h3>
                    <p class="vietnamese mb-2">Cách chia</p>
                    
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        <!-- Vowel Ending -->
                        <div class="bg-gray-50 p-3 rounded-lg text-center">
                            <div class="font-bold text-blue-600 mb-1">받침 X / ㄹ 받침</div>
                            <div class="text-xl font-bold mb-1">+ ㄹ 생각이다</div>
                            <div class="text-gray-500 text-xs">
                                가다 &rarr; 갈 생각이다<br>
                                살다 &rarr; 살 생각이다
                            </div>
                        </div>
                        <!-- Consonant Ending -->
                        <div class="bg-gray-50 p-3 rounded-lg text-center">
                            <div class="font-bold text-red-500 mb-1">받침 O</div>
                            <div class="text-xl font-bold mb-1">+ 을 생각이다</div>
                            <div class="text-gray-500 text-xs">
                                먹다 &rarr; 먹을 생각이다<br>
                                찾다 &rarr; 찾을 생각이다
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Examples from Image -->
                <div class="space-y-3">
                    <h3 class="font-bold text-gray-800 border-l-4 border-teal-500 pl-2">예문</h3>
                    <p class="vietnamese mb-2">Ví dụ</p>
                    
                    <div class="bg-white border rounded-lg p-3 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between items-start">
                            <p class="text-gray-800 font-medium">아이는 두 명 정도 낳을 생각이에요.</p>
                            <button onclick="speakText('아이는 두 명 정도 낳을 생각이에요')" class="text-teal-500 hover:text-teal-700 ml-2">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <p class="vietnamese mt-1">Tôi định sinh khoảng 2 con.</p>
                    </div>

                    <div class="bg-white border rounded-lg p-3 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between items-start">
                            <p class="text-gray-800 font-medium">대학원에 진학할 계획이에요.</p>
                            <button onclick="speakText('대학원에 진학할 계획이에요')" class="text-teal-500 hover:text-teal-700 ml-2">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <p class="vietnamese mt-1">Tôi có kế hoạch học lên cao học.</p>
                    </div>

                    <div class="bg-white border rounded-lg p-3 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between items-start">
                            <p class="text-gray-800 font-medium">유럽으로 출장을 다녀올 예정입니다.</p>
                            <button onclick="speakText('유럽으로 출장을 다녀올 예정입니다')" class="text-teal-500 hover:text-teal-700 ml-2">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <p class="vietnamese mt-1">Tôi dự định đi công tác ở Châu Âu.</p>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Quiz -->
            <div id="content-quiz" class="hidden fade-in space-y-6">
                <div class="text-center mb-4">
                    <h3 class="font-bold text-lg text-gray-800">빈칸에 알맞은 말을 고르세요.</h3>
                    <p class="vietnamese">Chọn từ thích hợp vào chỗ trống.</p>
                </div>

                <!-- Quiz Item 1 -->
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <p class="mb-3 font-medium text-lg">주말에 집에서 푹 ( 쉬다 ) ______.</p>
                    <div class="grid grid-cols-1 gap-2">
                        <!-- Distractor: Wrong conjugation (쉬을) -->
                        <button onclick="checkAnswer(this, false)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">1. 쉬을 생각이에요</button>
                        <!-- Correct Answer -->
                        <button onclick="checkAnswer(this, true)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">2. 쉴 생각이에요</button>
                        <!-- Distractor: Wrong form (쉰 - past modifier) -->
                        <button onclick="checkAnswer(this, false)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">3. 쉰 생각이에요</button>
                    </div>
                    <div class="result-msg hidden mt-2 text-sm font-bold"></div>
                </div>

                 <!-- Quiz Item 2 -->
                 <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <p class="mb-3 font-medium text-lg">한국 음식을 ( 만들다 ) ______.</p>
                    <div class="grid grid-cols-1 gap-2">
                        <!-- Correct Answer -->
                        <button onclick="checkAnswer(this, true)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">1. 만들 계획이에요</button>
                        <!-- Distractor: Wrong conjugation (ㄹ irregular error) -->
                        <button onclick="checkAnswer(this, false)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">2. 만들을 계획이에요</button>
                        <!-- Distractor: Wrong form (만든 - past modifier) -->
                        <button onclick="checkAnswer(this, false)" class="w-full text-left p-3 bg-white border rounded hover:bg-gray-100">3. 만든 계획이에요</button>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">* 'ㄹ' 받침 조심하세요! <span class="vietnamese inline">(Lưu ý phụ âm cuối 'ㄹ'!)</span></p>
                    <div class="result-msg hidden mt-2 text-sm font-bold"></div>
                </div>

                <div class="text-center">
                    <button onclick="resetQuiz()" class="bg-teal-600 text-white px-6 py-2 rounded-full hover:bg-teal-700 transition shadow">
                        다시 풀기 <span class="vietnamese inline">(Làm lại)</span>
                    </button>
                </div>
            </div>

            <!-- Tab 3: Practice (Life Plan) -->
            <div id="content-practice" class="hidden fade-in space-y-5">
                <div class="text-center">
                    <h3 class="font-bold text-lg text-gray-800">나의 인생 계획</h3>
                    <p class="vietnamese text-sm mb-4">빈칸을 채우고 문장을 만들어 보세요.</p>
                </div>

                <div class="relative border-l-2 border-teal-300 ml-4 pl-6 space-y-8">
                    
                    <!-- 1 Year -->
                    <div class="relative">
                        <span class="absolute -left-[33px] bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">1</span>
                        <label class="block text-sm font-bold text-gray-700 mb-1">1년 후 <span class="vietnamese inline font-normal ml-1">(Sau 1 năm)</span></label>
                        <input type="text" id="plan-1y" placeholder="예: 졸업하다, 취직하다" class="w-full p-2 border rounded focus:ring-2 focus:ring-teal-500 focus:outline-none bg-gray-50">
                    </div>

                    <!-- 10 Years -->
                    <div class="relative">
                        <span class="absolute -left-[33px] bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">10</span>
                        <label class="block text-sm font-bold text-gray-700 mb-1">10년 후 <span class="vietnamese inline font-normal ml-1">(Sau 10 năm)</span></label>
                        <input type="text" id="plan-10y" placeholder="예: 결혼하다, 집을 사다" class="w-full p-2 border rounded focus:ring-2 focus:ring-teal-500 focus:outline-none bg-gray-50">
                    </div>

                     <!-- 20 Years -->
                     <div class="relative">
                        <span class="absolute -left-[33px] bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">20</span>
                        <label class="block text-sm font-bold text-gray-700 mb-1">20년 후 <span class="vietnamese inline font-normal ml-1">(Sau 20 năm)</span></label>
                        <input type="text" id="plan-20y" placeholder="예: 세계 여행을 하다" class="w-full p-2 border rounded focus:ring-2 focus:ring-teal-500 focus:outline-none bg-gray-50">
                    </div>

                </div>

                <button onclick="generateSentences()" class="w-full bg-teal-600 text-white py-3 rounded-lg font-bold shadow hover:bg-teal-700 transition mt-4">
                    문장 만들기 <span class="vietnamese inline font-normal">(Tạo câu)</span>
                </button>

                <!-- Result Area -->
                <div id="plan-result" class="hidden bg-yellow-50 p-4 rounded-lg border border-yellow-200 mt-4 relative">
                    <h4 class="font-bold text-yellow-800 mb-2">나의 계획 <span class="vietnamese inline font-normal text-sm">(Kế hoạch của tôi)</span>:</h4>
                    <ul id="plan-list" class="space-y-2 text-gray-700">
                        <!-- Generated sentences will go here -->
                    </ul>
                    <button onclick="speakPlan()" class="absolute top-2 right-2 text-yellow-600 hover:text-yellow-800">
                        <i class="fas fa-volume-up"></i> 듣기
                    </button>
                </div>

            </div>

        </main>
        
        <!-- Footer -->
        <footer class="bg-gray-100 p-3 text-center text-xs text-gray-500">
            © 2025 Korean Grammar Class | Designed for You
        </footer>

    </div>

    <script>
        // Language Toggle Logic
        function toggleLanguage() {
            document.body.classList.toggle('show-vi');
            const btn = document.getElementById('lang-btn');
            
            if (document.body.classList.contains('show-vi')) {
                btn.classList.add('bg-teal-700', 'text-white');
                btn.classList.remove('bg-white', 'text-teal-700');
            } else {
                btn.classList.remove('bg-teal-700', 'text-white');
                btn.classList.add('bg-white', 'text-teal-700');
            }
        }

        // Tab Switching Logic
        function switchTab(tabName) {
            // Hide all contents
            document.getElementById('content-learn').classList.add('hidden');
            document.getElementById('content-quiz').classList.add('hidden');
            document.getElementById('content-practice').classList.add('hidden');
            
            // Remove active styles from tabs
            const tabs = ['learn', 'quiz', 'practice'];
            tabs.forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                btn.classList.remove('text-teal-600', 'border-b-2', 'border-teal-600');
                btn.classList.add('text-gray-500');
            });

            // Show selected content
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            
            // Add active style to selected tab
            const activeBtn = document.getElementById(`tab-${tabName}`);
            activeBtn.classList.remove('text-gray-500');
            activeBtn.classList.add('text-teal-600', 'border-b-2', 'border-teal-600');
        }

        // TTS Function
        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ko-KR';
                utterance.rate = 0.9; // Slightly slower for learners
                window.speechSynthesis.speak(utterance);
            } else {
                alert('이 브라우저는 음성 지원을 하지 않습니다.');
            }
        }

        // Quiz Logic
        function checkAnswer(btn, isCorrect) {
            const parent = btn.parentElement;
            const msgDiv = parent.nextElementSibling;
            
            // Reset styles for siblings
            Array.from(parent.children).forEach(child => {
                child.classList.remove('bg-green-100', 'border-green-500', 'bg-red-100', 'border-red-500');
                child.classList.add('bg-white');
            });

            msgDiv.classList.remove('hidden', 'text-green-600', 'text-red-600');

            if (isCorrect) {
                btn.classList.remove('bg-white');
                btn.classList.add('bg-green-100', 'border-green-500');
                msgDiv.innerHTML = "정답입니다! <span class='vietnamese inline font-normal'>(Chính xác!)</span>";
                msgDiv.classList.add('text-green-600');
                playFeedbackAudio(true);
            } else {
                btn.classList.remove('bg-white');
                btn.classList.add('bg-red-100', 'border-red-500');
                msgDiv.innerHTML = "틀렸습니다. <span class='vietnamese inline font-normal'>(Sai rồi)</span>";
                msgDiv.classList.add('text-red-600');
                playFeedbackAudio(false);
            }
        }

        function playFeedbackAudio(isCorrect) {
            // Optional: Simple beep or sound could go here
        }

        function resetQuiz() {
            const resultMsgs = document.querySelectorAll('.result-msg');
            resultMsgs.forEach(msg => msg.classList.add('hidden'));
            
            const options = document.querySelectorAll('#content-quiz button');
            options.forEach(opt => {
                if(opt.innerText.includes('다시 풀기')) return;
                opt.classList.remove('bg-green-100', 'border-green-500', 'bg-red-100', 'border-red-500');
                opt.classList.add('bg-white');
            });
        }

        // Sentence Generator Logic
        function generateSentences() {
            const plan1 = document.getElementById('plan-1y').value.trim();
            const plan10 = document.getElementById('plan-10y').value.trim();
            const plan20 = document.getElementById('plan-20y').value.trim();

            const list = document.getElementById('plan-list');
            list.innerHTML = ''; // Clear previous

            if (!plan1 && !plan10 && !plan20) {
                alert('계획을 하나 이상 입력해주세요.');
                return;
            }

            const endings = ['생각이에요', '계획이에요', '예정이에요'];
            
            const plans = [
                { time: '1년 후에', text: plan1 },
                { time: '10년 후에', text: plan10 },
                { time: '20년 후에', text: plan20 }
            ];

            plans.forEach((p, index) => {
                if (p.text) {
                    let stem = p.text;
                    if (stem.endsWith('다')) stem = stem.slice(0, -1);
                    
                    let conjugated = '';
                    const lastChar = stem.charAt(stem.length - 1);
                    const hasBatchim = (lastChar.charCodeAt(0) - 44032) % 28 > 0;
                    const isRieul = (lastChar.charCodeAt(0) - 44032) % 28 === 8;

                    if (isRieul) {
                         conjugated = stem + ' ' + endings[index % 3]; 
                    } else if (hasBatchim) {
                        conjugated = stem + '을 ' + endings[index % 3];
                    } else {
                        conjugated = stem + 'ㄹ ' + endings[index % 3];
                    }

                    const li = document.createElement('li');
                    li.innerHTML = `저는 <b>${p.time}</b> ${conjugated}.`;
                    list.appendChild(li);
                }
            });

            document.getElementById('plan-result').classList.remove('hidden');
        }

        function speakPlan() {
            const text = document.getElementById('plan-list').innerText;
            speakText(text);
        }
    </script>
</body>
</html>
