<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ì˜ ë¯¸ë˜ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .grammar-highlight {
            color: #1d4ed8; /* Deeper blue color */
            font-weight: 700;
        }
        .choice-button {
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
        }
        .choice-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            border-color: #38bdf8;
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
        }
        /* Stat change indicator animation */
        .stat-indicator {
            position: absolute;
            right: 0;
            top: -25px;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            animation: fade-up-out 1.5s ease-in-out forwards;
        }
        @keyframes fade-up-out {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }
    </style>
</head>
<body class="bg-sky-100 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="bg-white rounded-2xl shadow-2xl p-4 sm:p-6 md:p-8 max-w-2xl w-full mx-auto">
        
        <h1 class="text-2xl md:text-3xl font-bold text-center text-slate-800 mb-2">ë‚˜ì˜ ë¯¸ë˜ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° ğŸš€</h1>
        <p class="text-center text-slate-500 mb-6">ë‹¹ì‹ ì˜ ì„ íƒì´ ë¯¸ë˜ë¥¼ ë§Œë“­ë‹ˆë‹¤!</p>

        <div id="stats-container" class="grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4 mb-6 text-sm">
            <!-- Stats will be dynamically inserted here -->
        </div>

        <div class="bg-slate-50 rounded-lg p-4 sm:p-6 mb-6 min-h-[150px] flex flex-col justify-center">
            <div class="flex items-center gap-4">
                <img id="avatar" src="https://placehold.co/80x80/a7f3d0/333333?text=ğŸ˜Š" alt="Avatar" class="rounded-full w-16 h-16 md:w-20 md:h-20 flex-shrink-0">
                <div>
                    <h2 id="story-title" class="font-bold text-lg text-slate-800 mb-1">ì‚¬íšŒì´ˆë…„ìƒ</h2>
                    <p id="story-text" class="text-slate-600">ê²Œì„ì´ ê³§ ì‹œì‘ë©ë‹ˆë‹¤...</p>
                </div>
            </div>
        </div>
        
        <div id="choices-container" class="grid grid-cols-1 gap-4">
            <!-- Choices will be dynamically inserted here -->
        </div>
    </div>

    <!-- Modal for Game Over and Endings -->
    <div id="modal-container" class="hidden fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 max-w-md w-full mx-auto text-center">
            <img id="modal-image" src="" class="w-24 h-24 mx-auto mb-4 rounded-full" alt="Result Image">
            <h2 id="modal-title" class="text-2xl font-bold text-slate-800 mb-2"></h2>
            <p id="modal-text" class="text-slate-600 mb-6"></p>
            <div id="modal-stats-container" class="mb-6"></div>
            <button id="restart-button" class="w-full bg-sky-500 text-white p-3 rounded-lg font-bold hover:bg-sky-600">ìƒˆë¡œìš´ ì¸ìƒ ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

<script>
    // Initial stat values
    const initialStats = {
        happiness: { name: 'ğŸ˜Š í–‰ë³µ', value: 50, color: 'bg-yellow-400' },
        health: { name: 'â¤ï¸ ê±´ê°•', value: 70, color: 'bg-red-500' },
        money: { name: 'ğŸ’° ì¬ì‚°', value: 10, color: 'bg-green-500' },
        career: { name: 'ğŸ‘” ê²½ë ¥', value: 0, color: 'bg-blue-500' }
    };

    let stats = JSON.parse(JSON.stringify(initialStats));

    // Expanded event tree with more stages and grammar points
    const events = {
        start: {
            title: "ì²« íšŒì‚¬, ì²« ë‹¤ì§",
            story: "ë“œë””ì–´ ì²« ì¶œê·¼ì…ë‹ˆë‹¤! ì•ìœ¼ë¡œ íšŒì‚¬ì—ì„œ ì–´ë–»ê²Œ ì¼í•˜ê³  ì‹¶ìœ¼ì„¸ìš”?",
            avatar: "https://placehold.co/80x80/a7f3d0/333333?text=ğŸ¤”",
            choices: [
                { text: "ìµœê³ ê°€ ë˜ê³  ì‹¶ì–´ìš”. ì•¼ê·¼ë„ ì—´ì‹¬íˆ <span class='grammar-highlight'>í•  ê³„íšì´ì—ìš”</span>.", effect: { career: 15, money: 5, health: -15, happiness: -10 }, next: 'first_salary' },
                { text: "ì¼ê³¼ ì‚¶ì˜ ê· í˜•ì´ ì¤‘ìš”í•´ìš”. ì •ì‹œì— í‡´ê·¼<span class='grammar-highlight'>í•  ìƒê°ì´ì—ìš”</span>.", effect: { happiness: 10, health: 5, career: 5 }, next: 'first_salary' }
            ]
        },
        first_salary: {
            title: "ì²« ì›”ê¸‰!",
            story: "ê¸°ë‹¤ë¦¬ë˜ ì²« ì›”ê¸‰ì„ ë°›ì•˜ì–´ìš”! ì´ ëˆìœ¼ë¡œ ë¬´ì—‡ì„ ê°€ì¥ ë¨¼ì € í•˜ê³  ì‹¶ìœ¼ì„¸ìš”?",
            avatar: "https://placehold.co/80x80/fef08a/333333?text=ğŸ‰",
            choices: [
                { text: "ë¯¸ë˜ë¥¼ ìœ„í•´ ì €ì¶•ì„ <span class='grammar-highlight'>í•  ê³„íšì´ì—ìš”</span>.", effect: { money: 15, happiness: 5 }, next: 'colleague_trouble' },
                { text: "ì €ë¥¼ ìœ„í•œ ì„ ë¬¼ì„ <span class='grammar-highlight'>ì‚´ ì˜ˆì •ì´ì—ìš”</span>.", effect: { happiness: 15, money: -5 }, next: 'colleague_trouble' }
            ]
        },
        colleague_trouble: {
            title: "ë™ë£Œì˜ ë¶€íƒ",
            story: "ë™ë£Œê°€ í‡´ê·¼í•˜ê¸° ì „ì— ì¼ì„ ë„ì™€ë‹¬ë¼ê³  ë¶€íƒí–ˆì–´ìš”. ì–´ë–»ê²Œ í•˜ì‹œê² ì–´ìš”?",
            avatar: "https://placehold.co/80x80/d1d5db/333333?text=ğŸ˜¥",
            choices: [
                { text: "íŒ€ì›Œí¬ê°€ ì¤‘ìš”í•˜ë‹ˆê¹Œìš”. ë™ë£Œë¥¼ <span class='grammar-highlight'>ë„ì™€ì¤„ ìƒê°ì´ì—ìš”</span>.", effect: { career: 10, happiness: 5, health: -5 }, next: 'hobby' },
                { text: "ì œ ì¼ë„ ë°”ë¹ ìš”. ë¯¸ì•ˆí•˜ì§€ë§Œ ê±°ì ˆ<span class='grammar-highlight'>í•  ìƒê°ì´ì—ìš”</span>.", effect: { health: 5, career: -5 }, next: 'hobby' }
            ]
        },
        hobby: {
            title: "ë¬´ë£Œí•œ ì£¼ë§",
            story: "ì£¼ë§ì— íŠ¹ë³„í•œ ì¼ì´ ì—†ì–´ì„œ ì‹¬ì‹¬í•´ìš”. ë¬´ì—‡ì„ í•˜ë©´ì„œ ì‹œê°„ì„ ë³´ë‚´ë©´ ì¢‹ì„ê¹Œìš”?",
            avatar: "https://placehold.co/80x80/e9d5ff/333333?text=ğŸ§˜",
            choices: [
                { text: "ì œ ê²½ë ¥ì— ë„ì›€ì´ ë˜ëŠ” ì™¸êµ­ì–´ ê³µë¶€ë¥¼ <span class='grammar-highlight'>ì‹œì‘í•  ê³„íšì´ì—ìš”</span>.", effect: { career: 15, money: -5, happiness: -5 }, next: 'burnout' },
                { text: "ë” ì¦ê²ê²Œ ì‚´ê¸° ìœ„í•´ì„œ ìƒˆë¡œìš´ ì·¨ë¯¸ë¥¼ <span class='grammar-highlight'>ì°¾ì•„ë³¼ ìƒê°ì´ì—ìš”</span>.", effect: { happiness: 15, health: 5, money: -5 }, next: 'burnout' }
            ]
        },
        burnout: {
            title: "ì°¾ì•„ì˜¨ ë²ˆì•„ì›ƒ",
            story: "ì¼ì´ ë„ˆë¬´ ë§ì•„ì„œ ë²ˆì•„ì›ƒì´ ì˜¨ ê²ƒ ê°™ì•„ìš”. ì–´ë–»ê²Œ í•˜ë©´ ì¢‹ì„ê¹Œìš”?",
            avatar: "https://placehold.co/80x80/e9d5ff/333333?text=ğŸ˜µ",
            choices: [
                { text: "ê±´ê°•ì´ ê°€ì¥ ì¤‘ìš”í•´ìš”. ìš´ë™ì„ <span class='grammar-highlight'>ì‹œì‘í•  ê³„íšì´ì—ìš”</span>.", effect: { health: 20, money: -5, happiness: 5 }, next: 'health_check' },
                { text: "ì ì‹œ ì‰¬ì–´ì•¼ í•´ìš”. íœ´ê°€ë¥¼ ë‚´ì„œ ì—¬í–‰ì„ <span class='grammar-highlight'>ë‹¤ë…€ì˜¬ ì˜ˆì •ì´ì—ìš”</span>.", effect: { happiness: 20, health: 10, money: -10, career: -5 }, next: 'health_check' }
            ]
        },
        health_check: {
            title: "ê±´ê°•ê²€ì§„ ê²°ê³¼",
            story: "ê±´ê°•ê²€ì§„ì„ ë°›ì•˜ëŠ”ë°, ì˜ì‚¬ ì„ ìƒë‹˜ì´ ê±´ê°• ê´€ë¦¬ê°€ í•„ìš”í•˜ë‹¤ê³  í–ˆì–´ìš”.",
            avatar: "https://placehold.co/80x80/fca5a5/333333?text=ğŸ©º",
            choices: [
                { text: "ì‹ë‹¨ì„ ì¡°ì ˆí•˜ê³  ìš´ë™ì„ <span class='grammar-highlight'>í•  ê³„íšì´ì—ìš”</span>. ê±´ê°•ì€ ì¤‘ìš”í•˜ë‹ˆê¹Œìš”.", effect: { health: 25, happiness: -5 }, next: 'opportunity' },
                { text: "ì•„ì§ ê´œì°®ì•„ìš”. ì§€ê¸ˆì€ ì¦ê²ê²Œ <span class='grammar-highlight'>ì‚´ ì˜ˆì •ì´ì—ìš”</span>.", effect: { happiness: 15, health: -20 }, next: 'opportunity' }
            ]
        },
        opportunity: {
            title: "ì´ì§ ì œì•ˆ",
            story: "ë” ì¢‹ì€ ì¡°ê±´ìœ¼ë¡œ ë‹¤ë¥¸ íšŒì‚¬ì—ì„œ ì˜¤ë¼ê³  ì—°ë½ì´ ì™”ì–´ìš”. ì–´ë–»ê²Œ í•˜ì‹œê² ì–´ìš”?",
            avatar: "https://placehold.co/80x80/6ee7b7/333333?text=ğŸ’¼",
            choices: [
                { text: "ìƒˆë¡œìš´ ê³³ì—ì„œ ë„ì „<span class='grammar-highlight'>í•  ì˜ˆì •ì´ì—ìš”</span>.", effect: { career: 20, money: 15, happiness: -5 }, next: 'investment' },
                { text: "ì§€ê¸ˆ íšŒì‚¬ ë™ë£Œë“¤ì´ ì¢‹ì•„ìš”. ì—¬ê¸°ì— <span class='grammar-highlight'>ë‚¨ì„ ìƒê°ì´ì—ìš”</span>.", effect: { happiness: 10, career: 10 }, next: 'investment' }
            ]
        },
        investment: {
            title: "ëª©ëˆì´ ìƒê²¼ë‹¤",
            story: "ëˆì„ ê½¤ ë§ì´ ëª¨ì•˜ì–´ìš”. ì´ ëˆì„ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œìš”?",
            avatar: "https://placehold.co/80x80/bae6fd/333333?text=ğŸ“ˆ",
            choices: [
                { text: "ì•ˆì „í•œ ê²ƒì´ ì¢‹ì•„ìš”. ì€í–‰ì— <span class='grammar-highlight'>ì €ì¶•í•  ì˜ˆì •ì´ì—ìš”</span>.", effect: { money: 20, happiness: 5 }, next: 'relationship' },
                { text: "í•œ ë²ˆì— í° ëˆì„ ë²Œê³  ì‹¶ì–´ìš”. ì£¼ì‹ì— íˆ¬ì<span class='grammar-highlight'>í•  ìƒê°ì´ì—ìš”</span>.", effect: { money: Math.random() > 0.4 ? 40 : -30, career: 5 }, next: 'relationship' }
            ]
        },
        relationship: {
            title: "ì¸ì—°ì˜ ì‹œì‘",
            story: "ì†Œê°œíŒ…ì—ì„œ ì¢‹ì€ ì‚¬ëŒì„ ë§Œë‚¬ì–´ìš”. ì—°ì• ë¥¼ ì‹œì‘í•´ ë³¼ê¹Œìš”?",
            avatar: "https://placehold.co/80x80/f9a8d4/333333?text=â¤ï¸",
            choices: [
                { text: "ê°™ì´ ìˆìœ¼ë©´ ë” í–‰ë³µí•  ê±°ì˜ˆìš”. ì—°ì• ë¥¼ <span class='grammar-highlight'>ì‹œì‘í•  ìƒê°ì´ì—ìš”</span>.", effect: { happiness: 25, money: -10, career: -5 }, next: 'promotion_stress' },
                { text: "ì§€ê¸ˆì€ ì¼ì´ ë” ì¤‘ìš”í•´ìš”. ì—°ì• ëŠ” ë‚˜ì¤‘ì— <span class='grammar-highlight'>í•  ê³„íšì´ì—ìš”</span>.", effect: { career: 15, happiness: -10 }, next: 'promotion_stress' }
            ]
        },
        promotion_stress: {
            title: "ìŠ¹ì§„, ê·¸ë¦¬ê³  ìŠ¤íŠ¸ë ˆìŠ¤",
            story: "íŒ€ì¥ìœ¼ë¡œ ìŠ¹ì§„í–ˆì§€ë§Œ, ì¼ì´ ë§ì•„ì ¸ì„œ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë§ì´ ë°›ì•„ìš”.",
            avatar: "https://placehold.co/80x80/facc15/333333?text=ğŸ¤¯",
            choices: [
                { text: "ê´œì°®ì•„ì§ˆ ê±°ì˜ˆìš”. ì¡°ê¸ˆ ë” ì°¸ê³  <span class='grammar-highlight'>ì¼í•  ìƒê°ì´ì—ìš”</span>.", effect: { career: 25, health: -15, happiness: -10 }, next: 'mid_life_crisis' },
                { text: "íŒ€ì›ë“¤ì—ê²Œ ì¼ì„ ë‚˜ëˆ„ì–´ì£¼ê³ , ì €ë¥¼ ë” <span class='grammar-highlight'>ëŒë³¼ ê³„íšì´ì—ìš”</span>.", effect: { career: 10, happiness: 15, health: 5 }, next: 'mid_life_crisis' }
            ]
        },
        mid_life_crisis: {
            title: "15ë…„ í›„, ì¤‘ë…„ì˜ ìœ„ê¸°",
            story: "15ë…„ì´ ì§€ë‚¬ì–´ìš”. 'ë‚˜ëŠ” ì§€ê¸ˆ ì˜ ì‚´ê³  ìˆì„ê¹Œ?' ë¼ëŠ” ìƒê°ì´ ë“¤ì–´ìš”.",
            avatar: "https://placehold.co/80x80/9ca3af/333333?text=â³",
            choices: [
                { text: "ìƒˆë¡œìš´ ê²ƒì„ ë°°ìš°ê³  ì‹¶ì–´ìš”. ëŒ€í•™ì›ì— <span class='grammar-highlight'>ê°ˆ ê³„íšì´ì—ìš”</span>.", effect: { career: 30, money: -25, health: -10 }, next: 'final_choice' },
                { text: "íœ´ì‹ì´ í•„ìš”í•´ìš”. 1ë…„ ë™ì•ˆ ì„¸ê³„ ì—¬í–‰ì„ <span class='grammar-highlight'>ë– ë‚  ìƒê°ì´ì—ìš”</span>.", effect: { happiness: 35, health: 15, career: -15, money: -20 }, next: 'final_choice' }
            ]
        },
        final_choice: {
            title: "ì¸ìƒì˜ í™©í˜¼ê¸°",
            story: "ì´ì œ ê³§ ì€í‡´í•´ìš”. ë‚¨ì€ ì¸ìƒì„ ì–´ë–»ê²Œ ë³´ë‚´ê³  ì‹¶ìœ¼ì„¸ìš”?",
            avatar: "https://placehold.co/80x80/fde047/333333?text=ğŸ†",
            choices: [
                { text: "ë¶€ìë¡œ ì‚´ê³  ì‹¶ì–´ìš”. ëˆ ê´€ë¦¬ì— <span class='grammar-highlight'>ì§‘ì¤‘í•  ê³„íšì´ì—ìš”</span>.", next: 'end', effect: { money: 30, happiness: -5 } },
                { text: "ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ìš”. ê°€ì¡±ê³¼ í–‰ë³µí•˜ê²Œ <span class='grammar-highlight'>ì§€ë‚¼ ìƒê°ì´ì—ìš”</span>.", next: 'end', effect: { happiness: 30, health: 5 } }
            ]
        },
        gameOver_health: { title: "GAME OVER", story: "ê±´ê°•ì„ ìƒìœ¼ë©´ ëª¨ë“  ê²ƒì„ ìƒì–´ìš”. ë‹¤ìŒì—” ê±´ê°•ì„ ê¼­ ì±™ê¸°ì„¸ìš”!", avatar: "https://placehold.co/80x80/fca5a5/333333?text=ğŸ¤’" },
        gameOver_money: { title: "GAME OVER", story: "ëˆì´ ì—†ìœ¼ë©´ ì‚´ê¸° í˜ë“¤ì–´ìš”. ë‹¤ìŒì—” ê³„íšì ìœ¼ë¡œ ëˆì„ ì“°ì„¸ìš”!", avatar: "https://placehold.co/80x80/d1d5db/333333?text=ğŸ’¸" },
        gameOver_happiness: { title: "GAME OVER", story: "í–‰ë³µí•˜ì§€ ì•Šìœ¼ë©´ ì˜ë¯¸ê°€ ì—†ì–´ìš”. ë‹¹ì‹ ì˜ í–‰ë³µì„ ë¨¼ì € ìƒê°í•˜ì„¸ìš”!", avatar: "https://placehold.co/80x80/a5f3fc/333333?text=ğŸ˜­" },
        gameOver_career: { title: "GAME OVER", story: "ì¹˜ì—´í•œ ê²½ìŸì—ì„œ ë„íƒœë˜ì—ˆì–´ìš”. ë‹¹ì‹ ì˜ ëŠ¥ë ¥ì„ ë” ë°œì „ì‹œì¼œ ë³´ì„¸ìš”!", avatar: "https://placehold.co/80x80/facc15/333333?text=ğŸ“‰" },
        end: {} // Trigger for the ending screen
    };

    const DOM = {
        statsContainer: document.getElementById('stats-container'),
        storyTitle: document.getElementById('story-title'),
        storyText: document.getElementById('story-text'),
        choicesContainer: document.getElementById('choices-container'),
        avatar: document.getElementById('avatar'),
        modal: {
            container: document.getElementById('modal-container'),
            image: document.getElementById('modal-image'),
            title: document.getElementById('modal-title'),
            text: document.getElementById('modal-text'),
            statsContainer: document.getElementById('modal-stats-container'),
            restartButton: document.getElementById('restart-button')
        }
    };

    function updateStatsUI() {
        DOM.statsContainer.innerHTML = '';
        for (const key in stats) {
            const stat = stats[key];
            const statElement = document.createElement('div');
            // Added position-relative for stat change indicator positioning
            statElement.className = "bg-slate-100 p-2 sm:p-3 rounded-lg relative";
            statElement.id = `stat-box-${key}`; // Unique ID for each stat box
            statElement.innerHTML = `
                <div class="flex justify-between mb-1 items-center">
                    <span class="font-semibold text-slate-600 text-xs sm:text-sm">${stat.name}</span>
                    <span class="font-bold text-slate-800">${stat.value}/100</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div class="h-2.5 rounded-full progress-bar-fill ${stat.color}" style="width: ${stat.value}%"></div>
                </div>`;
            DOM.statsContainer.appendChild(statElement);
        }
    }

    // Function to show animated stat changes
    function showStatChange(key, change) {
        const statBox = document.getElementById(`stat-box-${key}`);
        if (!statBox) return;

        const indicator = document.createElement('div');
        indicator.textContent = `${change > 0 ? '+' : ''}${change}`;
        indicator.className = `stat-indicator ${change > 0 ? 'bg-green-500' : 'bg-red-500'}`;
        
        statBox.appendChild(indicator);

        setTimeout(() => {
            indicator.remove();
        }, 1500); // Remove after animation ends
    }

    function showEvent(eventId) {
        if (eventId === 'end') {
            showEndingScreen();
            return;
        }

        const event = events[eventId];
        DOM.storyTitle.textContent = event.title;
        DOM.storyText.textContent = event.story;
        DOM.avatar.src = event.avatar;
        DOM.choicesContainer.innerHTML = '';

        if (event.choices) {
            event.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = "choice-button w-full bg-sky-500 text-white p-3 sm:p-4 rounded-lg font-bold hover:bg-sky-600 text-left";
                button.innerHTML = choice.text;
                button.onclick = () => selectChoice(choice);
                DOM.choicesContainer.appendChild(button);
            });
        }
        updateStatsUI();
    }
    
    function checkGameOver() {
        for (const key in stats) {
            if (stats[key].value <= 0) {
                const gameOverEvent = events[`gameOver_${key}`];
                DOM.modal.image.src = gameOverEvent.avatar;
                DOM.modal.title.textContent = gameOverEvent.title;
                DOM.modal.text.textContent = gameOverEvent.story;
                DOM.modal.statsContainer.innerHTML = '';
                DOM.modal.container.classList.remove('hidden');
                return true;
            }
        }
        return false;
    }
    
    // Updated function for diverse endings
    function showEndingScreen() {
        let endingTitle = "ë‚˜ì˜ ì¸ìƒ ê²°ê³¼";
        let endingMessage = "";
        let endingAvatar = "";

        const { happiness, health, money, career } = stats;

        if (career.value >= 90 && money.value >= 80) {
            endingMessage = "ìì‹ ì˜ ë¶„ì•¼ì—ì„œ ìµœê³ ê°€ ë˜ì—ˆê³ , ê²½ì œì  ììœ ê¹Œì§€ ì–»ì—ˆêµ°ìš”! ëª¨ë‘ê°€ ìš°ëŸ¬ëŸ¬ë³´ëŠ” ì„±ê³µì ì¸ ì‚¶ì„ ì‚´ì•˜ìŠµë‹ˆë‹¤.";
            endingAvatar = "https://placehold.co/80x80/c084fc/333333?text=ğŸ‘‘";
        } else if (money.value >= 90 && happiness.value < 40) {
            endingMessage = "ì—„ì²­ë‚œ ë¶€ë¥¼ ì–»ì—ˆì§€ë§Œ, ê·¸ ê³¼ì •ì—ì„œ í–‰ë³µì„ ìƒì–´ë²„ë ¸ë„¤ìš”. ëˆìœ¼ë¡œëŠ” ì‚´ ìˆ˜ ì—†ëŠ” ê²ƒë“¤ë„ ìˆë‹µë‹ˆë‹¤.";
            endingAvatar = "https://placehold.co/80x80/94a3b8/333333?text= lonely";
        } else if (happiness.value >= 90 && health.value >= 80) {
            endingMessage = "ë¬¼ì§ˆì ì¸ ì„±ê³µë³´ë‹¤ëŠ” ë§ˆìŒì˜ í‰í™”ì™€ ê±´ê°•ì„ ì¶”êµ¬í–ˆêµ°ìš”. ì›ƒìŒê³¼ í™œê¸°ê°€ ë„˜ì¹˜ëŠ” ë©‹ì§„ ì¸ìƒì´ì—ˆìŠµë‹ˆë‹¤!";
            endingAvatar = "https://placehold.co/80x80/fde047/333333?text=ğŸ˜„";
        } else if (career.value >= 80 && health.value < 40) {
            endingMessage = "ì„±ê³µì„ ìœ„í•´ ì•ë§Œ ë³´ê³  ë‹¬ë ¤ì˜¤ëŠë¼ ê±´ê°•ì„ ëŒë³´ì§€ ëª»í–ˆêµ°ìš”. ì¼ë³´ë‹¤ ì†Œì¤‘í•œ ê²ƒì´ ë¬´ì—‡ì¸ì§€ ìƒê°í•´ë³´ì„¸ìš”.";
            endingAvatar = "https://placehold.co/80x80/f87171/333333?text=ğŸ¥";
        } else if (happiness.value >= 80 && money.value >= 50 && career.value < 70) {
            endingMessage = "ì„±ê³µë³´ë‹¤ëŠ” ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”ì‹œí–ˆë„¤ìš”. ë‹¹ì‹ ì˜ ê³ì—ëŠ” í•­ìƒ ì‚¬ëŒë“¤ì´ í•¨ê»˜í•˜ëŠ” ë”°ëœ»í•œ ì¸ìƒì´ì—ˆìŠµë‹ˆë‹¤.";
            endingAvatar = "https://placehold.co/80x80/fb923c/333333?text=ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦";
        } else if (happiness.value > 50 && health.value > 50 && money.value > 50 && career.value > 50) {
             endingMessage = "ì–´ëŠ í•œìª½ì— ì¹˜ìš°ì¹˜ì§€ ì•Šê³ , ëª¨ë“  ë©´ì—ì„œ ê· í˜•ì„ ì´ë£¨ëŠ” ì•ˆì •ì ì¸ ì‚¶ì„ ì‚´ì•˜ë„¤ìš”. í‰ë²”í•˜ì§€ë§Œ ê°€ì¥ ì–´ë ¤ìš´ í–‰ë³µì„ ì´ë¤˜ìŠµë‹ˆë‹¤.";
            endingAvatar = "https://placehold.co/80x80/34d399/333333?text=ğŸ‘";
        }
        else {
            endingMessage = "ë‹¹ì‹ ë§Œì˜ ë…íŠ¹í•œ ì¸ìƒê¸¸ì„ ê±¸ì–´ì™”ìŠµë‹ˆë‹¤. ë¹„ë¡ íŠ¹ë³„í•œ ì„±ì·¨ëŠ” ì—†ì—ˆì„ì§€ë¼ë„, ë‹¹ì‹ ì˜ ëª¨ë“  ì„ íƒì€ ì†Œì¤‘í–ˆìŠµë‹ˆë‹¤.";
            endingAvatar = "https://placehold.co/80x80/a78bfa/333333?text=ğŸ˜Š";
        }

        DOM.modal.image.src = endingAvatar;
        DOM.modal.title.textContent = endingTitle;
        DOM.modal.text.textContent = endingMessage;
        DOM.modal.statsContainer.innerHTML = DOM.statsContainer.innerHTML; // Show final stats
        DOM.modal.container.classList.remove('hidden');
    }

    function selectChoice(choice) {
        // Disable all buttons to prevent multiple clicks
        const buttons = DOM.choicesContainer.getElementsByTagName('button');
        for (const button of buttons) {
            button.disabled = true;
            button.classList.add('opacity-50', 'cursor-not-allowed'); // Visual feedback
        }

        if (choice.effect) {
            for (const key in choice.effect) {
                const change = choice.effect[key];
                stats[key].value += change;
                if (stats[key].value > 100) stats[key].value = 100;
                if (stats[key].value < 0) stats[key].value = 0;
                showStatChange(key, change); // Show visual feedback
            }
        }
        
        // Update the stat bars after a short delay to allow the animation to be seen
        setTimeout(() => {
            updateStatsUI();
            if (!checkGameOver()) {
                showEvent(choice.next);
            }
        }, 1000); // 1 second delay
    }

    function restartGame() {
        stats = JSON.parse(JSON.stringify(initialStats));
        DOM.modal.container.classList.add('hidden');
        showEvent('start');
    }
    
    DOM.modal.restartButton.onclick = restartGame;
    
    window.onload = () => {
        showEvent('start');
    };
</script>

</body>
</html>


